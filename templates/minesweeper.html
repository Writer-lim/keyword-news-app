<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€ë¢° ì°¾ê¸° ê²Œì„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f0f4f8;
        }
        /* ê²Œì„ ë³´ë“œ ìŠ¤íƒ€ì¼ */
        .game-grid {
            display: grid;
            border: 4px solid #334155;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            margin: 0 auto;
            /* ê³ ì • ë„ˆë¹„ ë° í¬ê¸° ì¤„ì–´ë“¦ ë°©ì§€ (ë¬¸ì œ 1 í•´ê²°) */
            width: 308px; /* 10 * 30px + 2 * 4px border + 2 * 1px gap ì—¬ìœ ë¶„ */
            height: 308px;
            flex-shrink: 0;
        }
        /* ê° ì…€ ìŠ¤íƒ€ì¼ */
        .cell {
            width: 30px;
            height: 30px;
            background-color: #d1d5db; /* Gray-300 */
            border: 1px solid #9ca3af; /* Gray-400 */
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.1s;
            font-size: 16px;
        }
        .cell:hover:not(.revealed):not(.flagged) {
            background-color: #e5e7eb; /* Gray-200 on hover */
        }
        .cell.revealed {
            background-color: #f3f4f6; /* Gray-100 */
            cursor: default;
        }
        /* íŠ¹ìˆ˜ ì…€ ìŠ¤íƒ€ì¼ */
        .cell.mine {
            background-color: #ef4444; /* Red-500 */
            color: white;
            font-size: 18px; /* í­íƒ„ ì•„ì´ì½˜ í¬ê¸° */
        }
        .cell.flagged {
            background-color: #22c55e; /* Green-500 */
            color: white;
            font-size: 18px; /* ê¹ƒë°œ ì•„ì´ì½˜ í¬ê¸° */
        }
        /* ìˆ«ìë³„ ìƒ‰ìƒ */
        .count-1 { color: #2563eb; } /* Blue-600 */
        .count-2 { color: #16a34a; } /* Green-600 */
        .count-3 { color: #dc2626; } /* Red-600 */
        .count-4 { color: #4338ca; } /* Indigo-700 */
        .count-5 { color: #9a3412; } /* Amber-800 */
        .count-6 { color: #0f766e; } /* Teal-600 */
        .count-7 { color: #1e293b; } /* Slate-800 */
        .count-8 { color: #64748b; } /* Slate-500 */
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <div class="bg-white p-8 rounded-xl shadow-2xl">
        <h1 class="text-4xl font-bold text-center mb-6 text-gray-800">ğŸ’£ ì§€ë¢° ì°¾ê¸° ê²Œì„</h1>
        
        <div class="flex justify-around items-center mb-6 text-xl font-semibold">
            <div id="mines-left" class="text-red-600"><i class="fas fa-bomb mr-2"></i> ì§€ë¢°: 10</div>
            <div id="timer" class="text-blue-600"><i class="fas fa-clock mr-2"></i> ì‹œê°„: 0</div>
        </div>

        <div id="status" class="text-xl text-center mb-6 font-semibold text-gray-700">ê²Œì„ì„ ì‹œì‘í•˜ì„¸ìš”!</div>
        
        <div id="game-container" class="mx-auto">
            <div id="board" class="game-grid">
                </div>
        </div>

        <button id="reset-button" class="mt-8 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg shadow-lg transition-transform transform hover:scale-[1.02] active:scale-95">
            ê²Œì„ ì¬ì‹œì‘
        </button>
        <a href="/" class="block mt-4 text-center text-indigo-500 hover:text-indigo-700 font-medium">
            â† ë©”ì¸ ê²€ìƒ‰ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°
        </a>
    </div>

    <script>
        // --- ì§€ë¢° ì°¾ê¸° ê²Œì„ ì„¤ì • ---
        const ROWS = 10;
        const COLS = 10;
        const MINES = 10;

        // --- ì „ì—­ ë³€ìˆ˜ ---
        let boardData = [];
        let gameActive = false;
        let timerInterval = null;
        let timeElapsed = 0;
        let minesFlagged = 0;
        let cellsRevealed = 0;

        // --- DOM ìš”ì†Œ ---
        const boardElement = document.getElementById('board');
        const statusElement = document.getElementById('status');
        const minesLeftElement = document.getElementById('mines-left');
        const timerElement = document.getElementById('timer');
        const resetButton = document.getElementById('reset-button');

        // ë³´ë“œ ì´ˆê¸°í™”
        function initializeBoard() {
            boardData = [];
            for (let i = 0; i < ROWS; i++) {
                boardData[i] = [];
                for (let j = 0; j < COLS; j++) {
                    boardData[i][j] = {
                        isMine: false,
                        isRevealed: false,
                        isFlagged: false,
                        neighborMines: 0,
                        id: i * COLS + j
                    };
                }
            }
        }

        // ì§€ë¢° ëœë¤ ë°°ì¹˜
        function placeMines(initialRow, initialCol) {
            let minesPlaced = 0;
            while (minesPlaced < MINES) {
                const row = Math.floor(Math.random() * ROWS);
                const col = Math.floor(Math.random() * COLS);

                // ì²« í´ë¦­ ì§€ì  ì£¼ë³€ 8ì¹¸ì—ëŠ” ì§€ë¢°ë¥¼ ë†“ì§€ ì•ŠìŒ
                if (!boardData[row][col].isMine && 
                    (Math.abs(row - initialRow) > 1 || Math.abs(col - initialCol) > 1)) {
                    
                    boardData[row][col].isMine = true;
                    minesPlaced++;
                }
            }
        }

        // ì£¼ë³€ ì§€ë¢° ê°œìˆ˜ ê³„ì‚°
        function calculateNeighbors() {
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    if (boardData[r][c].isMine) continue;

                    let count = 0;
                    for (let dr = -1; dr <= 1; dr++) {
                        for (let dc = -1; dc <= 1; dc++) {
                            const nr = r + dr;
                            const nc = c + dc;

                            if (nr >= 0 && nr < ROWS && nc >= 0 && nc < COLS && boardData[nr][nc].isMine) {
                                count++;
                            }
                        }
                    }
                    boardData[r][c].neighborMines = count;
                }
            }
        }
        
        // UI ë Œë”ë§ ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • (ë¬¸ì œ 2 í•´ê²°: ë¦¬ì…‹ ì‹œ ë³´ë“œ ì „ì²´ë¥¼ ìƒˆë¡œ ê·¸ë¦¼)
        function renderBoard() {
            boardElement.style.gridTemplateColumns = `repeat(${COLS}, 1fr)`;
            boardElement.innerHTML = ''; // ê¸°ì¡´ DOM ìš”ì†Œ ì œê±°í•˜ì—¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ëˆ„ì  ë°©ì§€
            
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    const cellData = boardData[r][c];
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.dataset.row = r;
                    cell.dataset.col = c;
                    
                    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
                    cell.addEventListener('contextmenu', (e) => {
                        e.preventDefault();
                        if (gameActive) toggleFlag(r, c);
                    });
                    cell.addEventListener('click', () => {
                        // ê²Œì„ ìƒíƒœì™€ ê´€ê³„ì—†ì´ handleClickì„ í˜¸ì¶œí•˜ì—¬ ì²« í´ë¦­ ë¡œì§ì„ ì²˜ë¦¬í•˜ê²Œ í•¨
                        handleClick(r, c);
                    });

                    updateCellDisplay(cell, cellData);
                    boardElement.appendChild(cell);
                }
            }
        }

        // ì…€ì˜ ìƒíƒœë¥¼ ì‹œê°ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸
        function updateCellDisplay(cellElement, cellData) {
            cellElement.classList.remove('revealed', 'flagged', 'mine', 'count-1', 'count-2', 'count-3', 'count-4', 'count-5', 'count-6', 'count-7', 'count-8');
            cellElement.textContent = '';
            
            if (cellData.isRevealed) {
                cellElement.classList.add('revealed');
                if (cellData.isMine) {
                    cellElement.classList.add('mine');
                    cellElement.innerHTML = '<i class="fas fa-bomb"></i>';
                } else if (cellData.neighborMines > 0) {
                    cellElement.classList.add(`count-${cellData.neighborMines}`);
                    cellElement.textContent = cellData.neighborMines;
                }
            } else if (cellData.isFlagged) {
                cellElement.classList.add('flagged');
                cellElement.innerHTML = '<i class="fas fa-flag"></i>';
            }
        }

        // ê²Œì„ ì‹œì‘ (ì²« í´ë¦­ ì‹œ ì§€ë¢° ë°°ì¹˜)
        function startGame(r, c) {
            placeMines(r, c);
            calculateNeighbors();
            gameActive = true;
            statusElement.textContent = "ê²Œì„ ì§„í–‰ ì¤‘...";
            
            // íƒ€ì´ë¨¸ ì‹œì‘
            timeElapsed = 0;
            timerElement.textContent = `ì‹œê°„: 0`;
            timerInterval = setInterval(() => {
                timeElapsed++;
                timerElement.textContent = `ì‹œê°„: ${timeElapsed}`;
            }, 1000);

            // ì²« í´ë¦­ ì²˜ë¦¬
            revealCell(r, c);
        }

        // í´ë¦­ ì²˜ë¦¬ (í•µì‹¬ ë¡œì§)
        function handleClick(r, c) {
            // ê²Œì„ì´ ë¹„í™œì„± ìƒíƒœì—ì„œ ì²« í´ë¦­ì´ë¼ë©´ ê²Œì„ ì‹œì‘
            if (cellsRevealed === 0) {
                startGame(r, c);
                updateBoardDisplay(); // ì²« í´ë¦­ í›„ ì£¼ë³€ ì…€ ìƒíƒœ ì—…ë°ì´íŠ¸
                return;
            }

            const cellData = boardData[r][c];
            if (!gameActive || cellData.isRevealed || cellData.isFlagged) return;

            if (cellData.isMine) {
                cellData.isRevealed = true;
                gameOver(false); // íŒ¨ë°°
            } else {
                revealCell(r, c);
                checkWin();
            }
            // ë§¤ë²ˆ í™”ë©´ ì—…ë°ì´íŠ¸
            updateBoardDisplay();
        }

        // ì…€ ì—´ê¸° (ì¬ê·€ë¥¼ í†µí•´ ì£¼ë³€ 0ì…€ ìë™ ì—´ê¸° ì²˜ë¦¬)
        function revealCell(r, c) {
            if (r < 0 || r >= ROWS || c < 0 || c >= COLS) return;
            
            const cellData = boardData[r][c];
            
            // ì´ë¯¸ ì—´ë ¸ê±°ë‚˜, ê¹ƒë°œì´ ìˆë‹¤ë©´ ë¦¬í„´ (ì§€ë¢°ëŠ” handleClickì—ì„œë§Œ í„°íŠ¸ë¦¼)
            if (cellData.isRevealed || cellData.isFlagged) return;
            
            // ì…€ì„ ì—´ê³  ì¹´ìš´íŠ¸ ì¦ê°€
            cellData.isRevealed = true;
            cellsRevealed++;

            if (cellData.neighborMines === 0) {
                // ì£¼ë³€ ì§€ë¢°ê°€ 0ê°œë©´ ì£¼ë³€ 8ì¹¸ë„ ì—´ê¸° (ì¬ê·€ í˜¸ì¶œ)
                for (let dr = -1; dr <= 1; dr++) {
                    for (let dc = -1; dc <= 1; dc++) {
                        if (dr !== 0 || dc !== 0) {
                            revealCell(r + dr, c + dc); 
                        }
                    }
                }
            }
        }
        
        // ê¹ƒë°œ í† ê¸€
        function toggleFlag(r, c) {
            if (!gameActive) return;

            const cellData = boardData[r][c];
            if (cellData.isRevealed) return;

            cellData.isFlagged = !cellData.isFlagged;
            minesFlagged += cellData.isFlagged ? 1 : -1;
            minesLeftElement.innerHTML = `<i class="fas fa-bomb mr-2"></i> ì§€ë¢°: ${MINES - minesFlagged}`;
            
            updateBoardDisplay();
            checkWin();
        }

        // ìŠ¹ë¦¬ ì¡°ê±´ í™•ì¸
        function checkWin() {
            const nonMineCells = ROWS * COLS - MINES;
            if (cellsRevealed === nonMineCells) {
                gameOver(true);
            }
        }
        
        // ê²Œì„ ì˜¤ë²„
        function gameOver(isWin) {
            gameActive = false;
            clearInterval(timerInterval);
            timerInterval = null;
            
            if (isWin) {
                statusElement.textContent = `ìŠ¹ë¦¬! ğŸ‰ (${timeElapsed}ì´ˆ)`;
                // ìŠ¹ë¦¬ ì‹œ ëª¨ë“  ì§€ë¢°ì— ê¹ƒë°œ í‘œì‹œ
                boardData.forEach(row => row.forEach(cell => {
                    if (cell.isMine && !cell.isFlagged) cell.isFlagged = true;
                }));
            } else {
                statusElement.textContent = "ê²Œì„ ì˜¤ë²„! ğŸ’¥";
                // íŒ¨ë°° ì‹œ ëª¨ë“  ì§€ë¢° ê³µê°œ
                boardData.forEach(row => row.forEach(cell => {
                    if (cell.isMine) cell.isRevealed = true;
                }));
            }
            updateBoardDisplay();
        }

        // ì „ì²´ ë³´ë“œ í™”ë©´ ì—…ë°ì´íŠ¸ (DOM ìš”ì†Œì™€ ë°ì´í„° ë™ê¸°í™”)
        function updateBoardDisplay() {
            // DOMì—ì„œ í•´ë‹¹í•˜ëŠ” ì…€ ìš”ì†Œë¥¼ ì°¾ì•„ì„œ ìƒíƒœ ì—…ë°ì´íŠ¸
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    const cellElement = boardElement.querySelector(`[data-row="${r}"][data-col="${c}"]`);
                    if (cellElement) {
                        updateCellDisplay(cellElement, boardData[r][c]);
                    }
                }
            }
        }

        // ê²Œì„ ë¦¬ì…‹
        function resetGame() {
            initializeBoard();
            renderBoard(); // ë³´ë“œì™€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì™„ì „íˆ ìƒˆë¡œ ë§Œë“¦
            gameActive = false;
            clearInterval(timerInterval);
            timerInterval = null;
            timeElapsed = 0;
            minesFlagged = 0;
            cellsRevealed = 0;
            
            statusElement.textContent = "ê²Œì„ì„ ì‹œì‘í•˜ì„¸ìš”! (ì²« í´ë¦­ ì‹œ ì§€ë¢° ë°°ì¹˜)";
            minesLeftElement.innerHTML = `<i class="fas fa-bomb mr-2"></i> ì§€ë¢°: ${MINES}`;
            timerElement.textContent = `ì‹œê°„: 0`;
        }

        // --- ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
        resetButton.addEventListener('click', resetGame);
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        resetGame();
    </script>
</body>
</html>