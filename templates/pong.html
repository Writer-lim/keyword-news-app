<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í ê²Œì„ (Pong Game)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        /* ìº”ë²„ìŠ¤ ì»¨í…Œì´ë„ˆ ë° ìŠ¤íƒ€ì¼ */
        #pong-container {
            position: relative;
            background-color: #1e293b; /* Slate-800 */
            border: 4px solid #334155;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            margin: 0 auto;
        }

        /* ê²Œì„ ìš”ì†Œì— ëŒ€í•œ í´ë˜ìŠ¤ ì •ì˜ëŠ” JSì—ì„œ ìº”ë²„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ í•„ìš” ì—†ìŒ */
        
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>

    <div class="bg-white p-6 rounded-xl shadow-2xl flex flex-col md:flex-row gap-6">
        
        <div class="w-full md:w-56 p-4 bg-gray-100 rounded-lg flex flex-col justify-between">
            <h1 class="text-3xl font-bold text-center mb-4 text-gray-800">ğŸ“ í ê²Œì„</h1>

            <div class="text-xl font-semibold mb-4 space-y-2">
                <div id="player-score" class="text-blue-600"><i class="fas fa-user mr-2"></i> ë‚´ ì ìˆ˜: 0</div>
                <div id="ai-score" class="text-red-600"><i class="fas fa-robot mr-2"></i> AI ì ìˆ˜: 0</div>
                <div id="status" class="text-gray-800 font-bold">ëŒ€ê¸° ì¤‘...</div>
            </div>

            <div class="mb-4 text-sm text-gray-700">
                <h3 class="font-bold mb-1">ğŸ® ì¡°ì‘ í‚¤ (ì™¼ìª½ íŒ¨ë“¤)</h3>
                <ul class="list-disc list-inside space-y-0.5">
                    <li>**ìœ„**: â†‘ (ë°©í–¥í‚¤ ìœ„)</li>
                    <li>**ì•„ë˜**: â†“ (ë°©í–¥í‚¤ ì•„ë˜)</li>
                    <li>**ë©ˆì¶¤/ì¬ê°œ**: Space (ìŠ¤í˜ì´ìŠ¤ ë°”)</li>
                </ul>
            </div>

            <button id="start-button" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-lg transition-transform transform hover:scale-[1.02] active:scale-95">
                ê²Œì„ ì‹œì‘
            </button>
        </div>

        <div id="pong-container">
            <canvas id="game-canvas" width="600" height="400"></canvas>
        </div>
    </div>

    <a href="/" class="block mt-4 text-center text-indigo-500 hover:text-indigo-700 font-medium">
        â† ë©”ì¸ ê²€ìƒ‰ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°
    </a>

    <script>
        // --- ê²Œì„ ì„¤ì • ---
        const CANVAS_WIDTH = 600;
        const CANVAS_HEIGHT = 400;
        const PADDLE_WIDTH = 10;
        const PADDLE_HEIGHT = 80;
        const BALL_SIZE = 10;
        const PADDLE_SPEED = 6;
        const AI_DIFFICULTY = 0.08; // 0.05 ~ 0.15 ì‚¬ì´, ë†’ì„ìˆ˜ë¡ ì–´ë ¤ì›€
        const MAX_SCORE = 10;
        
        // --- DOM ìš”ì†Œ ---
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const playerScoreDisplay = document.getElementById('player-score');
        const aiScoreDisplay = document.getElementById('ai-score');
        const statusElement = document.getElementById('status');
        const startButton = document.getElementById('start-button');

        // --- ê²Œì„ ê°ì²´ ---
        let player, ai, ball;
        let playerMoveUp = false;
        let playerMoveDown = false;
        let playerScore = 0;
        let aiScore = 0;
        let animationFrame;
        let isGameActive = false;
        let isGameOver = false;

        // --- ê°ì²´ ì •ì˜ í´ë˜ìŠ¤ ---

        class Paddle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.width = PADDLE_WIDTH;
                this.height = PADDLE_HEIGHT;
                this.color = color;
                this.score = 0;
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.width, this.height);
            }
        }

        class Ball {
            constructor(x, y, size, color) {
                this.x = x;
                this.y = y;
                this.size = size;
                this.color = color;
                this.speed = 4;
                this.dx = this.speed * (Math.random() < 0.5 ? 1 : -1); // ëœë¤ ìˆ˜í‰ ë°©í–¥
                this.dy = this.speed * (Math.random() * 2 - 1); // -speed ~ +speed ìˆ˜ì§ ë°©í–¥
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.size, this.size);
            }

            reset() {
                this.x = CANVAS_WIDTH / 2 - this.size / 2;
                this.y = CANVAS_HEIGHT / 2 - this.size / 2;
                this.speed = 4;
                
                // ê³µì˜ ë°©í–¥ì„ ìƒì€ í”Œë ˆì´ì–´ ìª½ìœ¼ë¡œ ì‹œì‘í•˜ë„ë¡ ì¡°ì •
                const direction = (playerScore > aiScore) ? 1 : -1;
                
                this.dx = this.speed * direction;
                this.dy = this.speed * (Math.random() * 2 - 1); 
            }
        }

        // --- ì´ˆê¸°í™” ë° ë Œë”ë§ ---

        function initializeGame() {
            // ê²Œì„ ê°ì²´ ì´ˆê¸°í™”
            player = new Paddle(10, CANVAS_HEIGHT / 2 - PADDLE_HEIGHT / 2, '#4ade80'); // Green
            ai = new Paddle(CANVAS_WIDTH - 10 - PADDLE_WIDTH, CANVAS_HEIGHT / 2 - PADDLE_HEIGHT / 2, '#f87171'); // Red
            ball = new Ball(CANVAS_WIDTH / 2 - BALL_SIZE / 2, CANVAS_HEIGHT / 2 - BALL_SIZE / 2, BALL_SIZE, '#ffffff'); // White
            
            // ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™”
            playerScore = 0;
            aiScore = 0;
            isGameActive = false;
            isGameOver = false;
            playerMoveUp = false;
            playerMoveDown = false;
            
            // í™”ë©´ ë° UI ì´ˆê¸°í™”
            ball.reset(); 
            updateScores();
            statusElement.textContent = "ì¤€ë¹„, ì‹œì‘ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.";
            startButton.textContent = "ê²Œì„ ì‹œì‘";
            
            drawElements();
        }
        
        function drawElements() {
            // ìº”ë²„ìŠ¤ ì´ˆê¸°í™” (ë°°ê²½)
            ctx.fillStyle = '#1e293b';
            ctx.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
            
            // ì¤‘ì•™ì„ 
            ctx.strokeStyle = '#64748b';
            ctx.setLineDash([10, 10]);
            ctx.beginPath();
            ctx.moveTo(CANVAS_WIDTH / 2, 0);
            ctx.lineTo(CANVAS_WIDTH / 2, CANVAS_HEIGHT);
            ctx.stroke();
            ctx.setLineDash([]); // ëŒ€ì‹œ ì´ˆê¸°í™”
            
            // ê°ì²´ ê·¸ë¦¬ê¸°
            player.draw();
            ai.draw();
            ball.draw();
        }

        // --- ê²Œì„ ë£¨í”„ ë° ë¡œì§ ---

        function gameLoop() {
            if (!isGameActive) {
                return;
            }
            
            update();
            drawElements();
            
            animationFrame = requestAnimationFrame(gameLoop);
        }

        function update() {
            // 1. í”Œë ˆì´ì–´ íŒ¨ë“¤ ì´ë™
            if (playerMoveUp) {
                player.y -= PADDLE_SPEED;
            } else if (playerMoveDown) {
                player.y += PADDLE_SPEED;
            }
            
            // ê²½ê³„ ì¶©ëŒ ë°©ì§€
            player.y = Math.max(0, Math.min(CANVAS_HEIGHT - PADDLE_HEIGHT, player.y));

            // 2. AI íŒ¨ë“¤ ì´ë™
            aiMovement();

            // 3. ê³µ ì´ë™
            ball.x += ball.dx;
            ball.y += ball.dy;

            // 4. ë²½ ì¶©ëŒ (ìƒí•˜)
            if (ball.y < 0 || ball.y + BALL_SIZE > CANVAS_HEIGHT) {
                ball.dy *= -1; // ë°©í–¥ ë°˜ì „
            }

            // 5. íŒ¨ë“¤ ì¶©ëŒ
            checkPaddleCollision(player);
            checkPaddleCollision(ai);

            // 6. ë“ì  (ì¢Œìš° ë²½ í†µê³¼)
            if (ball.x < 0) {
                // AI ë“ì 
                aiScore++;
                updateScores();
                checkWin();
                if (isGameActive) {
                    ball.reset();
                }
            } else if (ball.x + BALL_SIZE > CANVAS_WIDTH) {
                // í”Œë ˆì´ì–´ ë“ì 
                playerScore++;
                updateScores();
                checkWin();
                if (isGameActive) {
                    ball.reset();
                }
            }
        }

        // AI íŒ¨ë“¤ ë¡œì§
        function aiMovement() {
            const center = ai.y + ai.height / 2;
            const ballCenter = ball.y + ball.size / 2;
            
            // ê³µì˜ ìœ„ì¹˜ì— ë”°ë¼ íŒ¨ë“¤ì„ ì´ë™
            if (ballCenter < center) {
                // ê³µì´ ìœ„ìª½ì— ìˆìœ¼ë©´ ìœ„ë¡œ ì´ë™
                ai.y -= PADDLE_SPEED * AI_DIFFICULTY * Math.abs(center - ballCenter);
            } else if (ballCenter > center) {
                // ê³µì´ ì•„ë˜ìª½ì— ìˆìœ¼ë©´ ì•„ë˜ë¡œ ì´ë™
                ai.y += PADDLE_SPEED * AI_DIFFICULTY * Math.abs(center - ballCenter);
            }
            
            // ê²½ê³„ ì¶©ëŒ ë°©ì§€
            ai.y = Math.max(0, Math.min(CANVAS_HEIGHT - PADDLE_HEIGHT, ai.y));
        }

        // íŒ¨ë“¤ ì¶©ëŒ ì²˜ë¦¬
        function checkPaddleCollision(paddle) {
            // AABB(Axis-Aligned Bounding Box) ì¶©ëŒ ê°ì§€
            if (ball.x < paddle.x + paddle.width &&
                ball.x + ball.size > paddle.x &&
                ball.y < paddle.y + paddle.height &&
                ball.y + ball.size > paddle.y) {
                
                // ìˆ˜í‰ ë°©í–¥ ë°˜ì „
                ball.dx *= -1; 
                
                // ê³µì˜ ì†ë„ ì¦ê°€
                ball.speed = Math.min(ball.speed + 0.5, 10);
                
                // ì¶©ëŒ ì§€ì ì— ë”°ë¥¸ ìˆ˜ì§ ë°©í–¥ ê³„ì‚° (íŒ¨ë“¤ì˜ ì¤‘ì‹¬ì—ì„œ ë©€ìˆ˜ë¡ ìˆ˜ì§ ì†ë„ê°€ ì»¤ì§)
                let collidePoint = (ball.y + ball.size / 2) - (paddle.y + paddle.height / 2);
                collidePoint = collidePoint / (paddle.height / 2); // -1ì—ì„œ 1 ì‚¬ì´ì˜ ê°’ìœ¼ë¡œ ì •ê·œí™”
                
                ball.dy = ball.speed * collidePoint;
            }
        }

        // --- UI ë° ê²Œì„ ìƒíƒœ ê´€ë¦¬ ---

        function updateScores() {
            playerScoreDisplay.innerHTML = `<i class="fas fa-user mr-2"></i> ë‚´ ì ìˆ˜: ${playerScore}`;
            aiScoreDisplay.innerHTML = `<i class="fas fa-robot mr-2"></i> AI ì ìˆ˜: ${aiScore}`;
        }
        
        function checkWin() {
            if (playerScore >= MAX_SCORE || aiScore >= MAX_SCORE) {
                isGameActive = false;
                isGameOver = true;
                cancelAnimationFrame(animationFrame);
                
                const winner = playerScore >= MAX_SCORE ? "ë‹¹ì‹ " : "AI";
                statusElement.textContent = `ê²Œì„ ì¢…ë£Œ! ${winner} ìŠ¹ë¦¬! ğŸ‰`;
                startButton.textContent = "ë‹¤ì‹œ ì‹œì‘";
            }
        }

        function startGame() {
            if (!isGameActive || isGameOver) {
                initializeGame();
            }
            
            isGameActive = true;
            isGameOver = false;
            statusElement.textContent = "ê²Œì„ ì§„í–‰ ì¤‘...";
            startButton.textContent = "ì¼ì‹œ ì •ì§€ (Space)";
            
            gameLoop();
        }

        function togglePause() {
            if (isGameOver) return; 

            if (isGameActive) {
                isGameActive = false;
                cancelAnimationFrame(animationFrame);
                statusElement.textContent = "ì¼ì‹œ ì •ì§€ â¸ï¸";
                startButton.textContent = "ì¬ê°œ";
            } else { // ì¬ê°œ
                isGameActive = true;
                statusElement.textContent = "ê²Œì„ ì§„í–‰ ì¤‘...";
                startButton.textContent = "ì¼ì‹œ ì •ì§€ (Space)";
                gameLoop();
            }
        }

        // --- í‚¤ë³´ë“œ ì…ë ¥ ì²˜ë¦¬ ---
        document.addEventListener('keydown', (e) => {
            if (e.key === ' ' || e.key === 'Spacebar') {
                e.preventDefault();
                togglePause();
                return;
            }
            
            if (!isGameActive) return;

            switch (e.key) {
                case 'ArrowUp':
                    playerMoveUp = true;
                    e.preventDefault();
                    break;
                case 'ArrowDown':
                    playerMoveDown = true;
                    e.preventDefault();
                    break;
            }
        });

        document.addEventListener('keyup', (e) => {
            if (!isGameActive) return;

            switch (e.key) {
                case 'ArrowUp':
                    playerMoveUp = false;
                    break;
                case 'ArrowDown':
                    playerMoveDown = false;
                    break;
            }
        });


        // --- ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ì—°ê²° ---
        startButton.addEventListener('click', () => {
             if (startButton.textContent === 'ê²Œì„ ì‹œì‘' || startButton.textContent === 'ë‹¤ì‹œ ì‹œì‘') {
                startGame();
            } else {
                togglePause();
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        initializeGame();
    </script>
</body>
</html>